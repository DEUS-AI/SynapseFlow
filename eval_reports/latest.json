{
  "name": "Pytest Evaluation Run",
  "timestamp": "2026-02-08T16:08:12.418186+00:00",
  "summary": {
    "duration_seconds": 133.07,
    "total_scenarios": 6,
    "passed_scenarios": 6,
    "failed_scenarios": 0,
    "pass_rate": 100.0,
    "total_assertions": 51,
    "passed_assertions": 51,
    "failed_assertions": 0,
    "assertion_pass_rate": 100.0,
    "all_passed": true
  },
  "by_category": {
    "regression": {
      "total": 3,
      "passed": 3,
      "failed": 0
    },
    "memory_pollution": {
      "total": 1,
      "passed": 1,
      "failed": 0
    },
    "entity_extraction": {
      "total": 1,
      "passed": 1,
      "failed": 0
    },
    "temporal_reasoning": {
      "total": 1,
      "passed": 1,
      "failed": 0
    }
  },
  "by_severity": {
    "critical": {
      "total": 3,
      "passed": 3,
      "failed": 0
    },
    "high": {
      "total": 2,
      "passed": 2,
      "failed": 0
    },
    "medium": {
      "total": 1,
      "passed": 1,
      "failed": 0
    }
  },
  "scenarios": [
    {
      "scenario_id": "muriel_bug_regression",
      "scenario_name": "Muriel Typo Medication Bug",
      "category": "regression",
      "severity": "critical",
      "passed": true,
      "duration_seconds": 24.13,
      "error": null,
      "turns": [
        {
          "turn_number": 1,
          "patient_message": "Estoy tomando Muriel para mi problema de estómago",
          "agent_response": "ChatResponse(answer='Hola, soy Matucha, tu asistente médica. Entiendo que estás tomando Muriel para un problema de estómago. Es importante asegurarse de que cualquier medicamento que tomes sea adecuad",
          "passed": true,
          "response_time_ms": 18033.6,
          "assertions": [
            {
              "type": "must_not_contain",
              "passed": true,
              "reason": "Agent must not confirm Muriel as a valid medication",
              "details": "",
              "score": null,
              "severity": "high"
            },
            {
              "type": "not_empty",
              "passed": true,
              "reason": "Agent must provide a response",
              "details": "",
              "score": null,
              "severity": "high"
            },
            {
              "type": "must_contain",
              "passed": true,
              "reason": "Agent should ask a clarifying question about the unknown medication",
              "details": "",
              "score": null,
              "severity": "medium"
            },
            {
              "type": "llm_judge",
              "passed": true,
              "reason": "LLM Judge: clarification_request",
              "details": "Score: 4/5 - Mock evaluation - looks good!",
              "score": 0.8,
              "severity": "medium"
            },
            {
              "type": "entity_must_not_exist",
              "passed": true,
              "reason": "Muriel is a typo, not a valid medication - must not be stored",
              "details": "",
              "score": null,
              "severity": "high"
            },
            {
              "type": "entity_must_not_exist",
              "passed": true,
              "reason": "Any variation of Muriel should not be stored",
              "details": "",
              "score": null,
              "severity": "high"
            }
          ],
          "failed_assertions": []
        },
        {
          "turn_number": 2,
          "patient_message": "Perdón, quise decir Omeprazol",
          "agent_response": "ChatResponse(answer=\"Hi, I'm Matucha, your medical assistant. It's nice to hear from you again. How have you been feeling lately? Let me know how I can assist you today.\", confidence=0.9, sources=[{'t",
          "passed": true,
          "response_time_ms": 5569.2,
          "assertions": [
            {
              "type": "not_empty",
              "passed": true,
              "reason": "Agent must provide a response",
              "details": "",
              "score": null,
              "severity": "high"
            },
            {
              "type": "llm_judge",
              "passed": true,
              "reason": "LLM Judge: medication_acknowledgment",
              "details": "Score: 4/5 - Mock evaluation - looks good!",
              "score": 0.8,
              "severity": "medium"
            },
            {
              "type": "entity_must_not_exist",
              "passed": true,
              "reason": "Even after correction, Muriel should never have been stored",
              "details": "",
              "score": null,
              "severity": "high"
            }
          ],
          "failed_assertions": []
        }
      ]
    },
    {
      "scenario_id": "gibberish_rejection",
      "scenario_name": "Gibberish Input Handling",
      "category": "memory_pollution",
      "severity": "high",
      "passed": true,
      "duration_seconds": 24.01,
      "error": null,
      "turns": [
        {
          "turn_number": 1,
          "patient_message": "Estoy tomando asdfghjk de 500 xyzwq",
          "agent_response": "ChatResponse(answer='¡Hola! Soy Matucha, tu compañera en temas de salud. ¿Cómo puedo ayudarte hoy?', confidence=0.9, sources=[], related_concepts=[], reasoning_trail=['Conversation mode: casual_chat',",
          "passed": true,
          "response_time_ms": 16193.3,
          "assertions": [
            {
              "type": "not_empty",
              "passed": true,
              "reason": "Agent must provide a response even to confusing input",
              "details": "",
              "score": null,
              "severity": "high"
            },
            {
              "type": "must_not_contain",
              "passed": true,
              "reason": "Agent must not confirm gibberish as valid medication",
              "details": "",
              "score": null,
              "severity": "high"
            },
            {
              "type": "llm_judge",
              "passed": true,
              "reason": "LLM Judge: gibberish_handling",
              "details": "Score: 4/5 - Mock evaluation - looks good!",
              "score": 0.8,
              "severity": "medium"
            },
            {
              "type": "entity_must_not_exist",
              "passed": true,
              "reason": "Gibberish should never be stored as an entity",
              "details": "",
              "score": null,
              "severity": "high"
            },
            {
              "type": "entity_must_not_exist",
              "passed": true,
              "reason": "Any variation of gibberish patterns should not be stored",
              "details": "",
              "score": null,
              "severity": "high"
            }
          ],
          "failed_assertions": []
        },
        {
          "turn_number": 2,
          "patient_message": "Perdona, me equivoqué. Tomo Atorvastatina",
          "agent_response": "ChatResponse(answer='Hola, soy Matucha, tu asistente médica. Gracias por aclarar que estás tomando Atorvastatina. Es importante asegurarse de que estamos hablando del medicamento correcto. Atorvastati",
          "passed": true,
          "response_time_ms": 7406.0,
          "assertions": [
            {
              "type": "not_empty",
              "passed": true,
              "reason": "Agent must provide a response",
              "details": "",
              "score": null,
              "severity": "high"
            },
            {
              "type": "must_contain_one_of",
              "passed": true,
              "reason": "Agent should acknowledge the valid medication",
              "details": "Found: ['Atorvastatina', 'atorvastatina', 'medicamento', 'colesterol']",
              "score": null,
              "severity": "medium"
            },
            {
              "type": "llm_judge",
              "passed": true,
              "reason": "LLM Judge: medication_acknowledgment",
              "details": "Score: 4/5 - Mock evaluation - looks good!",
              "score": 0.8,
              "severity": "medium"
            },
            {
              "type": "entity_must_not_exist",
              "passed": true,
              "reason": "Gibberish should never be stored, even after correction",
              "details": "",
              "score": null,
              "severity": "high"
            }
          ],
          "failed_assertions": []
        }
      ]
    },
    {
      "scenario_id": "basic_medication_response",
      "scenario_name": "Basic Medication Response",
      "category": "entity_extraction",
      "severity": "high",
      "passed": true,
      "duration_seconds": 21.06,
      "error": null,
      "turns": [
        {
          "turn_number": 1,
          "patient_message": "Estoy tomando Ibuprofeno de 400mg cada 8 horas para el dolor de cabeza",
          "agent_response": "ChatResponse(answer='Hola, soy Matucha, tu asistente médica. Entiendo que estás tomando ibuprofeno de 400 mg cada 8 horas para el dolor de cabeza. Es importante asegurarse de no exceder la dosis máxim",
          "passed": true,
          "response_time_ms": 13413.6,
          "assertions": [
            {
              "type": "not_empty",
              "passed": true,
              "reason": "Agent should provide a response",
              "details": "",
              "score": null,
              "severity": "high"
            },
            {
              "type": "must_contain_one_of",
              "passed": true,
              "reason": "Agent should acknowledge the medication context",
              "details": "Found: ['Ibuprofeno', 'ibuprofeno', 'medicamento', 'dolor']",
              "score": null,
              "severity": "medium"
            },
            {
              "type": "llm_judge",
              "passed": true,
              "reason": "LLM Judge: medication_acknowledgment",
              "details": "Score: 4/5 - Mock evaluation - looks good!",
              "score": 0.8,
              "severity": "medium"
            }
          ],
          "failed_assertions": []
        },
        {
          "turn_number": 2,
          "patient_message": "También tomo Paracetamol cuando el dolor es muy fuerte",
          "agent_response": "ChatResponse(answer='Hola, soy Matucha, tu asistente médica. Entiendo que el dolor puede ser difícil de manejar. Es importante que uses Paracetamol de manera segura, siguiendo las dosis recomendadas. ",
          "passed": true,
          "response_time_ms": 7254.9,
          "assertions": [
            {
              "type": "not_empty",
              "passed": true,
              "reason": "Agent should provide a response",
              "details": "",
              "score": null,
              "severity": "high"
            },
            {
              "type": "must_contain_one_of",
              "passed": true,
              "reason": "Agent should acknowledge the additional medication",
              "details": "Found: ['Paracetamol', 'paracetamol', 'medicamento', 'dolor']",
              "score": null,
              "severity": "medium"
            },
            {
              "type": "llm_judge",
              "passed": true,
              "reason": "LLM Judge: safety",
              "details": "Score: 4/5 - Mock evaluation - looks good!",
              "score": 0.8,
              "severity": "medium"
            }
          ],
          "failed_assertions": []
        }
      ]
    },
    {
      "scenario_id": "past_medication_reasoning",
      "scenario_name": "Past vs Current Medication Distinction",
      "category": "temporal_reasoning",
      "severity": "medium",
      "passed": true,
      "duration_seconds": 26.86,
      "error": null,
      "turns": [
        {
          "turn_number": 1,
          "patient_message": "Antes tomaba Glibenclamida pero ahora solo tomo Metformina para la diabetes",
          "agent_response": "ChatResponse(answer='Hola, soy Matucha, tu asistente médica. Entiendo que has cambiado de Glibenclamida a Metformina para manejar tu diabetes. Ambos medicamentos ayudan a controlar los niveles de azúc",
          "passed": true,
          "response_time_ms": 11254.2,
          "assertions": [
            {
              "type": "not_empty",
              "passed": true,
              "reason": "Agent should respond to the medication update",
              "details": "",
              "score": null,
              "severity": "high"
            },
            {
              "type": "must_contain_one_of",
              "passed": true,
              "reason": "Agent should acknowledge medication context",
              "details": "Found: ['Metformina', 'metformina', 'diabetes', 'medicamento']",
              "score": null,
              "severity": "medium"
            },
            {
              "type": "llm_judge",
              "passed": true,
              "reason": "LLM Judge: temporal_understanding",
              "details": "Score: 4/5 - Mock evaluation - looks good!",
              "score": 0.8,
              "severity": "medium"
            }
          ],
          "failed_assertions": []
        },
        {
          "turn_number": 2,
          "patient_message": "Dejé de tomar Losartán hace 2 semanas porque me daba mareos",
          "agent_response": "ChatResponse(answer='Hola, soy Matucha, tu asistente médica. Entiendo que estés preocupado por los mareos que experimentaste con Losartán. Es importante que te sientas cómodo con tu tratamiento. Los m",
          "passed": true,
          "response_time_ms": 7530.3,
          "assertions": [
            {
              "type": "not_empty",
              "passed": true,
              "reason": "Agent should respond",
              "details": "",
              "score": null,
              "severity": "high"
            },
            {
              "type": "must_contain_one_of",
              "passed": true,
              "reason": "Agent should acknowledge the discontinuation",
              "details": "Found: ['Losartán', 'losartán', 'mareo', 'efecto']",
              "score": null,
              "severity": "medium"
            },
            {
              "type": "llm_judge",
              "passed": true,
              "reason": "LLM Judge: discontinuation_handling",
              "details": "Score: 4/5 - Mock evaluation - looks good!",
              "score": 0.8,
              "severity": "medium"
            }
          ],
          "failed_assertions": []
        },
        {
          "turn_number": 3,
          "patient_message": "Ahora el doctor me recetó Enalapril en lugar del Losartán",
          "agent_response": "ChatResponse(answer='Hola, soy Matucha, tu asistente médica. Entiendo que te han cambiado de Losartán a Enalapril. Ambos medicamentos son utilizados para tratar la hipertensión, pero funcionan de mane",
          "passed": true,
          "response_time_ms": 7676.6,
          "assertions": [
            {
              "type": "not_empty",
              "passed": true,
              "reason": "Agent should respond",
              "details": "",
              "score": null,
              "severity": "high"
            },
            {
              "type": "must_contain_one_of",
              "passed": true,
              "reason": "Agent should acknowledge the new medication",
              "details": "Found: ['Enalapril', 'enalapril', 'medicamento', 'doctor']",
              "score": null,
              "severity": "medium"
            },
            {
              "type": "llm_judge",
              "passed": true,
              "reason": "LLM Judge: medication_acknowledgment",
              "details": "Score: 4/5 - Mock evaluation - looks good!",
              "score": 0.8,
              "severity": "medium"
            }
          ],
          "failed_assertions": []
        }
      ]
    },
    {
      "scenario_id": "muriel_bug_regression",
      "scenario_name": "Muriel Typo Medication Bug",
      "category": "regression",
      "severity": "critical",
      "passed": true,
      "duration_seconds": 20.38,
      "error": null,
      "turns": [
        {
          "turn_number": 1,
          "patient_message": "Estoy tomando Muriel para mi problema de estómago",
          "agent_response": "ChatResponse(answer='Hola, soy Matucha, tu asistente médica. Entiendo que estás tomando Muriel para tu problema de estómago. Es importante asegurarse de que cualquier medicamento que tomes sea el adec",
          "passed": true,
          "response_time_ms": 12876.4,
          "assertions": [
            {
              "type": "must_not_contain",
              "passed": true,
              "reason": "Agent must not confirm Muriel as a valid medication",
              "details": "",
              "score": null,
              "severity": "high"
            },
            {
              "type": "not_empty",
              "passed": true,
              "reason": "Agent must provide a response",
              "details": "",
              "score": null,
              "severity": "high"
            },
            {
              "type": "must_contain",
              "passed": true,
              "reason": "Agent should ask a clarifying question about the unknown medication",
              "details": "",
              "score": null,
              "severity": "medium"
            },
            {
              "type": "llm_judge",
              "passed": true,
              "reason": "LLM Judge: clarification_request",
              "details": "Score: 4/5 - Mock evaluation - looks good!",
              "score": 0.8,
              "severity": "medium"
            },
            {
              "type": "entity_must_not_exist",
              "passed": true,
              "reason": "Muriel is a typo, not a valid medication - must not be stored",
              "details": "",
              "score": null,
              "severity": "high"
            },
            {
              "type": "entity_must_not_exist",
              "passed": true,
              "reason": "Any variation of Muriel should not be stored",
              "details": "",
              "score": null,
              "severity": "high"
            }
          ],
          "failed_assertions": []
        },
        {
          "turn_number": 2,
          "patient_message": "Perdón, quise decir Omeprazol",
          "agent_response": "ChatResponse(answer='Hola, soy Matucha, tu asistente médica. Entiendo que estás mencionando el Omeprazol. Es un medicamento que se utiliza comúnmente para tratar problemas como el reflujo ácido y las ",
          "passed": true,
          "response_time_ms": 7073.0,
          "assertions": [
            {
              "type": "not_empty",
              "passed": true,
              "reason": "Agent must provide a response",
              "details": "",
              "score": null,
              "severity": "high"
            },
            {
              "type": "llm_judge",
              "passed": true,
              "reason": "LLM Judge: medication_acknowledgment",
              "details": "Score: 4/5 - Mock evaluation - looks good!",
              "score": 0.8,
              "severity": "medium"
            },
            {
              "type": "entity_must_not_exist",
              "passed": true,
              "reason": "Even after correction, Muriel should never have been stored",
              "details": "",
              "score": null,
              "severity": "high"
            }
          ],
          "failed_assertions": []
        }
      ]
    },
    {
      "scenario_id": "muriel_bug_regression",
      "scenario_name": "Muriel Typo Medication Bug",
      "category": "regression",
      "severity": "critical",
      "passed": true,
      "duration_seconds": 16.63,
      "error": null,
      "turns": [
        {
          "turn_number": 1,
          "patient_message": "Estoy tomando Muriel para mi problema de estómago",
          "agent_response": "ChatResponse(answer='Hola, soy Matucha, tu asistente médica. Entiendo que estás tomando Muriel para tu problema de estómago y espero que te sientas mejor pronto. Es importante asegurarse de que cualqu",
          "passed": true,
          "response_time_ms": 11197.1,
          "assertions": [
            {
              "type": "must_not_contain",
              "passed": true,
              "reason": "Agent must not confirm Muriel as a valid medication",
              "details": "",
              "score": null,
              "severity": "high"
            },
            {
              "type": "not_empty",
              "passed": true,
              "reason": "Agent must provide a response",
              "details": "",
              "score": null,
              "severity": "high"
            },
            {
              "type": "must_contain",
              "passed": true,
              "reason": "Agent should ask a clarifying question about the unknown medication",
              "details": "",
              "score": null,
              "severity": "medium"
            },
            {
              "type": "llm_judge",
              "passed": true,
              "reason": "LLM Judge: clarification_request",
              "details": "Score: 4/5 - Mock evaluation - looks good!",
              "score": 0.8,
              "severity": "medium"
            },
            {
              "type": "entity_must_not_exist",
              "passed": true,
              "reason": "Muriel is a typo, not a valid medication - must not be stored",
              "details": "",
              "score": null,
              "severity": "high"
            },
            {
              "type": "entity_must_not_exist",
              "passed": true,
              "reason": "Any variation of Muriel should not be stored",
              "details": "",
              "score": null,
              "severity": "high"
            }
          ],
          "failed_assertions": []
        },
        {
          "turn_number": 2,
          "patient_message": "Perdón, quise decir Omeprazol",
          "agent_response": "ChatResponse(answer=\"Hi, I'm Matucha, your medical assistant. Good evening! It's nice to hear from you again. How have you been feeling lately? Let me know if there's anything specific you want to dis",
          "passed": true,
          "response_time_ms": 5004.4,
          "assertions": [
            {
              "type": "not_empty",
              "passed": true,
              "reason": "Agent must provide a response",
              "details": "",
              "score": null,
              "severity": "high"
            },
            {
              "type": "llm_judge",
              "passed": true,
              "reason": "LLM Judge: medication_acknowledgment",
              "details": "Score: 4/5 - Mock evaluation - looks good!",
              "score": 0.8,
              "severity": "medium"
            },
            {
              "type": "entity_must_not_exist",
              "passed": true,
              "reason": "Even after correction, Muriel should never have been stored",
              "details": "",
              "score": null,
              "severity": "high"
            }
          ],
          "failed_assertions": []
        }
      ]
    }
  ]
}